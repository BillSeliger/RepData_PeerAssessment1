---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

This R Markdown document is for Reproducible Research Peer Assessment 1. The course assignment can be found here <https://class.coursera.org/repdata-010/human_grading/view/courses/973511/assessments/3/submissions>

This assignment makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.  The original dataset can be found here <https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip>

The variables included in this dataset are:

- **steps**: Number of steps taking in a 5-minute interval (missing values are coded as NA)
- **date**: The date on which the measurement was taken in YYYY-MM-DD format
- **interval**: Identifier for the 5-minute interval in which measurement was taken
The dataset is stored in a comma-separated-value (CSV) file and there are a total of 17,568 observations in this dataset.

**Loading and preprocessing the data**


Set the working directory on my local computer
```{r}
setwd("C:/Users/rr046302/Documents/Bill's Stuff/Coursera/Reproducible Research/RepData_PeerAssessment1")
```


Read in the data from the local zipped file and, using the dplyr package, convert object to a tbl class
```{r, echo = F}
activity <- read.csv(unz("activity.zip","activity.csv"))
require(dplyr)
activity <- tbl_df(activity)
```

**What is mean total number of steps taken per day?**

For this part of the assignment, you can ignore the missing values in the dataset.
Make a histogram of the total number of steps taken each day

First we must aggregate the number of steps per day.  I use the group_by function and then the summarise function from dplyr to perform the aggregation of steps by day and then hist function to create the plot

```{r}
activity_days <- activity %>% group_by(date) %>% summarise(total.steps = sum(steps, na.rm =TRUE))
hist(activity_days$total.steps)
```

Calculate and report the mean total number of steps taken per day
```{r}
mean((activity_days$total.steps), na.rm = TRUE)
```

Calculate and report the median total number of steps taken per day
```{r}
median((activity_days$total.steps), na.rm = TRUE)
```

**What is the average daily activity pattern?**

Create a factor of the interval - time of day - so that we can aggregate based on it
```{r}
activity$interval.factor <- as.factor(activity$interval)
```

Calculate the average number of steps for each interval using the group_by and summarise functions
```{r}
activity_interval <- activity %>% group_by(interval.factor) %>% summarise(mean.steps = mean(steps, na.rm =TRUE))
```

Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r}
plot(activity_interval$interval.factor, activity_interval$mean.steps, type = "l", xlab = "<---Morning     5-minute intervals      Night--->", ylab = "mean steps per day", main = "Daily Activity Pattern", sub = "Average steps per day by 5-minute intervals")
```


Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
max_steps_interval <- which.max(activity_interval$mean.steps)
activity_interval[max_steps_interval,]
```


**Imputing missing values**
Note that there are a number of days/intervals where there are missing values (coded as NA). The presence of missing days may introduce bias into some calculations or summaries of the data.

Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)

```{r}
sum(is.na(activity$steps))
```

After reviewing the data I found that the NAs consist of a specific date consisting of NAs - in other words for each date for which there are observations there are no NAs and there are 8 days for which there are no observations at all - the observations for those 8 days are NAs.  In performing exploratory data analysis on the dataset I found that there are differences between the different weekdays for which we have observations.  

I will use the following strategy to impute missing values. \
- calculate the interval average for each weekday for which we have observations
- using the average number of steps for each interval I will impute the observations for matching weekdays



Create a new dataset that is equal to the original dataset but with the missing data filled in.

Make a histogram of the total number of steps taken each day and Calculate and report the mean and median total number of steps taken per day. Do these values differ from the estimates from the first part of the assignment? What is the impact of imputing missing data on the estimates of the total daily number of steps?



**Are there differences in activity patterns between weekdays and weekends?**





```{r}
setwd("C:/Users/rr046302/Documents/Bill's Stuff/Coursera/Reproducible Research/RepData_PeerAssessment1")
```


For final project use ## knit2html("PA1_template.Rmd")

```{r}

```
